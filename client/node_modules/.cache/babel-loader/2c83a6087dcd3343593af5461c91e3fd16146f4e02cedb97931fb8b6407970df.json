{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from 'axios';\n\n// Set default axios config\naxios.defaults.baseURL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\n\n// Set auth token\nconst setAuthToken = token => {\n  if (token) {\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n    localStorage.setItem('token', token);\n  } else {\n    delete axios.defaults.headers.common['Authorization'];\n    localStorage.removeItem('token');\n  }\n};\n\n// Load user\nexport const loadUser = createAsyncThunk('auth/loadUser', async (_, {\n  rejectWithValue\n}) => {\n  try {\n    const token = localStorage.getItem('token');\n    if (token) {\n      setAuthToken(token);\n    }\n    const response = await axios.get('/auth/me');\n    return response.data.user;\n  } catch (error) {\n    setAuthToken(null);\n    return rejectWithValue(error.response.data.message);\n  }\n});\n\n// Register user\nexport const register = createAsyncThunk('auth/register', async (userData, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await axios.post('/auth/register', userData);\n    const {\n      token,\n      user\n    } = response.data;\n    setAuthToken(token);\n    return {\n      token,\n      user\n    };\n  } catch (error) {\n    return rejectWithValue(error.response.data.message);\n  }\n});\n\n// Login user\nexport const login = createAsyncThunk('auth/login', async (userData, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await axios.post('/auth/login', userData);\n    const {\n      token,\n      user\n    } = response.data;\n    setAuthToken(token);\n    return {\n      token,\n      user\n    };\n  } catch (error) {\n    return rejectWithValue(error.response.data.message);\n  }\n});\nconst initialState = {\n  token: localStorage.getItem('token'),\n  isAuthenticated: false,\n  loading: false,\n  user: null,\n  error: null\n};\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    logout: state => {\n      setAuthToken(null);\n      state.token = null;\n      state.isAuthenticated = false;\n      state.user = null;\n      state.loading = false;\n      state.error = null;\n    },\n    clearError: state => {\n      state.error = null;\n    }\n  },\n  extraReducers: builder => {\n    builder\n    // Load User\n    .addCase(loadUser.pending, state => {\n      state.loading = true;\n    }).addCase(loadUser.fulfilled, (state, action) => {\n      state.loading = false;\n      state.isAuthenticated = true;\n      state.user = action.payload;\n      state.error = null;\n    }).addCase(loadUser.rejected, (state, action) => {\n      state.loading = false;\n      state.isAuthenticated = false;\n      state.user = null;\n      state.error = action.payload;\n    })\n    // Register\n    .addCase(register.pending, state => {\n      state.loading = true;\n    }).addCase(register.fulfilled, (state, action) => {\n      state.loading = false;\n      state.isAuthenticated = true;\n      state.token = action.payload.token;\n      state.user = action.payload.user;\n      state.error = null;\n    }).addCase(register.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload;\n    })\n    // Login\n    .addCase(login.pending, state => {\n      state.loading = true;\n    }).addCase(login.fulfilled, (state, action) => {\n      state.loading = false;\n      state.isAuthenticated = true;\n      state.token = action.payload.token;\n      state.user = action.payload.user;\n      state.error = null;\n    }).addCase(login.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload;\n    });\n  }\n});\nexport const {\n  logout,\n  clearError\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","defaults","baseURL","process","env","REACT_APP_API_URL","setAuthToken","token","headers","common","localStorage","setItem","removeItem","loadUser","_","rejectWithValue","getItem","response","get","data","user","error","message","register","userData","post","login","initialState","isAuthenticated","loading","authSlice","name","reducers","logout","state","clearError","extraReducers","builder","addCase","pending","fulfilled","action","payload","rejected","actions","reducer"],"sources":["F:/new/client/src/store/slices/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\n\r\n// Set default axios config\r\naxios.defaults.baseURL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\r\n\r\n// Set auth token\r\nconst setAuthToken = (token) => {\r\n  if (token) {\r\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n    localStorage.setItem('token', token);\r\n  } else {\r\n    delete axios.defaults.headers.common['Authorization'];\r\n    localStorage.removeItem('token');\r\n  }\r\n};\r\n\r\n// Load user\r\nexport const loadUser = createAsyncThunk('auth/loadUser', async (_, { rejectWithValue }) => {\r\n  try {\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      setAuthToken(token);\r\n    }\r\n    const response = await axios.get('/auth/me');\r\n    return response.data.user;\r\n  } catch (error) {\r\n    setAuthToken(null);\r\n    return rejectWithValue(error.response.data.message);\r\n  }\r\n});\r\n\r\n// Register user\r\nexport const register = createAsyncThunk('auth/register', async (userData, { rejectWithValue }) => {\r\n  try {\r\n    const response = await axios.post('/auth/register', userData);\r\n    const { token, user } = response.data;\r\n    setAuthToken(token);\r\n    return { token, user };\r\n  } catch (error) {\r\n    return rejectWithValue(error.response.data.message);\r\n  }\r\n});\r\n\r\n// Login user\r\nexport const login = createAsyncThunk('auth/login', async (userData, { rejectWithValue }) => {\r\n  try {\r\n    const response = await axios.post('/auth/login', userData);\r\n    const { token, user } = response.data;\r\n    setAuthToken(token);\r\n    return { token, user };\r\n  } catch (error) {\r\n    return rejectWithValue(error.response.data.message);\r\n  }\r\n});\r\n\r\nconst initialState = {\r\n  token: localStorage.getItem('token'),\r\n  isAuthenticated: false,\r\n  loading: false,\r\n  user: null,\r\n  error: null,\r\n};\r\n\r\nconst authSlice = createSlice({\r\n  name: 'auth',\r\n  initialState,\r\n  reducers: {\r\n    logout: (state) => {\r\n      setAuthToken(null);\r\n      state.token = null;\r\n      state.isAuthenticated = false;\r\n      state.user = null;\r\n      state.loading = false;\r\n      state.error = null;\r\n    },\r\n    clearError: (state) => {\r\n      state.error = null;\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      // Load User\r\n      .addCase(loadUser.pending, (state) => {\r\n        state.loading = true;\r\n      })\r\n      .addCase(loadUser.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.isAuthenticated = true;\r\n        state.user = action.payload;\r\n        state.error = null;\r\n      })\r\n      .addCase(loadUser.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.isAuthenticated = false;\r\n        state.user = null;\r\n        state.error = action.payload;\r\n      })\r\n      // Register\r\n      .addCase(register.pending, (state) => {\r\n        state.loading = true;\r\n      })\r\n      .addCase(register.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.isAuthenticated = true;\r\n        state.token = action.payload.token;\r\n        state.user = action.payload.user;\r\n        state.error = null;\r\n      })\r\n      .addCase(register.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      })\r\n      // Login\r\n      .addCase(login.pending, (state) => {\r\n        state.loading = true;\r\n      })\r\n      .addCase(login.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.isAuthenticated = true;\r\n        state.token = action.payload.token;\r\n        state.user = action.payload.user;\r\n        state.error = null;\r\n      })\r\n      .addCase(login.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      });\r\n  },\r\n});\r\n\r\nexport const { logout, clearError } = authSlice.actions;\r\nexport default authSlice.reducer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}